"0",""
"0",""
"0",""
"0","# maybe just directly incorporate resource consumption? Bad habitat causes more consumption, and this effect is _somehow_ passed to offspring? "
"0",""
"0",""
"0",""
"0","#' @param habitat percent corn (0-100)"
"0","#' @param size beetle size (scaled between 0 and 10)"
"0","#' can mess with relative effect of size and habitat on population growth rate as well"
"0","popGrowth <- function(habitat, size){"
"0","  #r <- 0.7 + (0.025*habitat) + (0.05*size)"
"0","  r <- 2.5 - (0.025*habitat) + (0.05*size)"
"0","  return(r)"
"0","}"
"0",""
"0",""
"0","#' @param habitat percent corn (0-100)"
"0","beetleSize <- function(habitat){"
"0","  size <- 0 + 0.1*habitat"
"0","  return(size)"
"0","}"
"0",""
"0",""
"0","getPopDynamics <- function(n=10, a=1.5, b=2, habVec, times=100){"
"0","  nt <- c()"
"0","  nt[1] <- n"
"0","  if(length(habVec)==1){"
"0","    habVec <- rep(habVec, times)"
"0","  }"
"0","  "
"0","  beetSize <- r <- c()"
"0","  for(i in 1:times){"
"0","    if(i ==1){"
"0","      beetSize[i] <- beetleSize(habVec[i])"
"0","      r[i] <- popGrowth(habVec[i], beetSize[i])"
"0","      nt[i+1] <- (nt[i] * r[i]) / ((1+(a*nt[i]))**b)"
"0","    }else{"
"0","      beetSize[i] <- beetleSize(mean(habVec[(i-1):i]))"
"0","      r[i] <- popGrowth(habVec[i], beetSize[i-1])"
"0","      nt[i+1] <- (nt[i] * r[i]) / ((1+(a*nt[i]))**b)"
"0","    }"
"0","  }"
"0","  return(data.frame(nt[1:times], beetSize, r, habVec))"
"0","}"
"0",""
"0",""
"0",""
"0","getGrowthRate <- function(pop){"
"0","  gr <- log(pop[2:length(pop)] / pop[1:(length(pop)-1)])"
"0","  return(gr)"
"0","}"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","test1 <- getPopDynamics(n=0.5, habVec=c(100, 0,0,0,0), times=5)"
"0","test2 <- getPopDynamics(n=0.5, habVec=c(80, 0,0,0,0), times=5)"
"0","test3 <- getPopDynamics(n=0.5, habVec=c(60, 0,0,0,0), times=5)"
"0","test4 <- getPopDynamics(n=0.5, habVec=c(40, 0,0,0,0), times=5)"
"0","test5 <- getPopDynamics(n=0.5, habVec=c(20, 0,0,0,0), times=5)"
"0","test6 <- getPopDynamics(n=0.5, habVec=c(0,0,0,0,0), times=5)"
"0",""
"0","gtest1 <- getGrowthRate(test1$nt)"
"0","gtest2 <- getGrowthRate(test2$nt)"
"0","gtest3 <- getGrowthRate(test3$nt)"
"0","gtest4 <- getGrowthRate(test4$nt)"
"0","gtest5 <- getGrowthRate(test5$nt)"
"0","gtest6 <- getGrowthRate(test6$nt)"
"0",""
"0",""
"0","colz <- topo.colors(6)"
"0","pdf('simGrowthRate.pdf', height=4, width=4.5)"
"0","par(mar=c(4,4,0.5,0.5))"
"0","plot(x=0:4, y=c(1,gtest1), type='b',  col=colz[1], pch=16, "
"0","  xlim=c(0,4), "
"0","  ylab='Population growth rate', "
"0","  xlab='Generation', xaxt='n')"
